general:
  branches:
    only:
      - master
      - develop

machine:
  timezone:
    Asia/Tokyo
  environment:
    ACCOUNT: circleci@yyyy-stg.iam.gserviceaccount.com
    GAE_GO_SDK_VERSION: 1.9.24
    PATH: $PATH:$HOME/go_appengine

dependencies:
  override:
  pre:
    - touch ~/.ssh/portfolio
    - echo $PRIVATE_KEY | base64 --decode --ignore-garbage > ~/.ssh/portfolio
    - chmod 400 ~/.ssh/portfolio
    - pyenv global 2.7.12
    - ssh $DOMAIN -i ~/.ssh/portfolio 'export PATH=$HOME/.rbenv/bin:$PATH; eval "$(rbenv init -)";sh /home/dracrowa/portfolio-desu/build.sh'
deployment:
  staging:
    branch: develop
    commands:
  production:
    branch: master
    commands:
